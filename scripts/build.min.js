class Settings{constructor(){this.name="",this.provider="Google",this.background="Default"}webSearch(){const e=document.querySelector(".search").querySelector("input"),t=e.value.trim();t&&("DuckDuckGo"===this.provider?window.open(`https://www.duckduckgo.com/?q=${t}`,"_blank"):window.open(`https://www.${this.provider}.com/search?q=${t}`,"_blank"),e.blur()),e.value=""}update(){localStorage.setItem("settings",JSON.stringify(this))}updateName(e){const t=document.querySelector(".personal-name input");e&&(this.name=e,this.update(),t.setAttribute("value",e))}updateProvider(){document.querySelector(".search input").setAttribute("placeholder",`Search ${this.provider}`)}updateBackground(){const e=document.querySelectorAll(".bg-img, .portrait"),t=document.querySelector(".custom-background input"),o=document.querySelector(".custom-background button");let r;switch(t.setAttribute("disabled","true"),o.setAttribute("disabled","true"),this.background){case"Daily":r="https://source.unsplash.com/daily",e.forEach(e=>{e.style.background=`url("${r}") no-repeat center/cover`});break;case"Custom":t.toggleAttribute("disabled"),o.toggleAttribute("disabled"),localStorage.getItem("unsplash")&&(r=JSON.parse(localStorage.getItem("unsplash"))[1],e.forEach(e=>{e.style.background=`url("${r}") no-repeat center/cover`}));break;default:e.forEach(e=>{e.removeAttribute("style")})}}updateRadio(e,t,o){const r=e.querySelectorAll("input");let a=this[t];o&&(a=o.value,this[t]=o.value,this.update()),r.forEach(e=>{e.value===a?e.setAttribute("checked",!0):e.removeAttribute("checked")})}}class Bookmarks{constructor(e,t,o,r){this.name=e,this.url=t,this.icon=o,this.type=r}}function clickSearch(e){const t=document.querySelector(".search").querySelector("input");t.value?e.webSearch():t.focus()}function checkBackground(){const e=document.querySelector(".custom-background input").value.trim(),t=e.split("/");if(t.length>4){const o=t[3].toLowerCase();let r=t[4];switch(o){case"photos":case"collections":"collections"===o&&(r=`collection/${r}`)}localStorage.setItem("unsplash",JSON.stringify([e,`https://source.unsplash.com/${r}/3000x2000`]))}}function updateTimeAndDate(){const e=document.querySelector(".time"),t=document.querySelector(".date"),o=document.querySelector("time"),r=new Date;e.innerHTML=r.toLocaleTimeString("en-gb",{hour:"2-digit",minute:"2-digit"}),t.innerHTML=r.toLocaleDateString("en-gb",{weekday:"long",month:"long",day:"numeric"}),o.setAttribute("datetime",r.toISOString()),setTimeout(updateTimeAndDate,1e3)}function modalTabs(e,t){e.querySelectorAll(".is-active").forEach(e=>{e.classList.remove("is-active")}),t.parentNode.classList.add("is-active"),e.querySelectorAll("[data-content]").forEach(e=>{e.setAttribute("hidden",!0),t.innerText===e.dataset.content&&e.toggleAttribute("hidden")})}function toggleModal(e,t){const o=document.querySelector(`#${e}.modal`);if(o.querySelectorAll(".tabs").length&&t){const e=o.querySelector(".tabs").parentNode,r=e.querySelectorAll(".tabs li a");modalTabs(e,r[t-1])}o.classList.toggle("is-active")}function resetAlerts(e){const t=e.querySelectorAll(".help"),o=e.querySelectorAll("input");t.forEach(e=>{e.classList.add("is-hidden")}),o.forEach(e=>{e.classList.remove("is-danger"),e.classList.add("is-primary")})}function updateWeather(){const e=document.querySelector(".weather-location"),t=JSON.parse(localStorage.getItem("coordinates")),o=`https://cors-anywhere.herokuapp.com/https://api.darksky.net/forecast/ca420a36227e83f3b5973ead080e6613/${t[0]},${t[1]}?exclude=minutely,hourly,daily,alerts,flags&units=auto`;e.querySelector("input").setAttribute("value",`${t[0]}, ${t[1]}`),fetch(o).then(e=>e.json()).then(e=>{const t=document.querySelector(".weather"),o=document.querySelector("#skycon");if("error"in e)t.querySelector("a").innerText="Invalid Location",t.classList.remove("is-size-5"),t.classList.add("is-size-6"),o.setAttribute("hidden","true");else{const r=new Skycons({color:"white"});t.querySelector("a").innerText=`${Math.round(e.currently.apparentTemperature)}°`,r.add(document.getElementById("skycon"),e.currently.icon),r.play(),t.classList.add("is-size-5"),t.classList.remove("is-size-6"),o.removeAttribute("hidden")}})}function allow(e){const t=document.querySelector(".weather-location input"),o=document.querySelector('[data-content="Weather"] .is-danger');t.value=`${e.coords.latitude.toFixed(5)}, ${e.coords.longitude.toFixed(5)}`,o.classList.add("is-hidden")}function block(){document.querySelector('[data-content="Weather"] .is-danger').classList.remove("is-hidden")}function updateCoords(){const e=document.querySelector(".weather-location input").value.replace(/ |\+/g,"").split(",");if(document.querySelector('[data-content="Weather"] .is-danger').classList.add("is-hidden"),e.length>1){const t=e[0],o=e[1];localStorage.setItem("coordinates",JSON.stringify([t,o])),updateWeather()}}function addFocus(e,t){const o=e.querySelector("input"),r=e.querySelector("button").parentNode;t&&(o.value=t);const a=o.value.trim();if(a){const t=document.createElement("a"),n=document.createTextNode(a);t.appendChild(n),t.classList.add("focus-message","has-text-primary"),e.appendChild(t),t.addEventListener("click",()=>{r.toggleAttribute("hidden"),o.setAttribute("type","text"),e.removeChild(e.lastChild)}),r.toggleAttribute("hidden"),o.setAttribute("type","hidden"),o.value=a;const s=new Date;localStorage.setItem("focus",JSON.stringify([a,s.toDateString()]))}else o.value=""}function updateWelcome(){const e=document.querySelector(".welcome-prefix"),t=(new Date).getHours(),o=document.querySelector(".personal-name input");e.innerText=t<12?"Good morning":t<18?"Good afternoon":"Good evening",o.value&&(e.innerText+=`, ${o.value}`),setTimeout(updateWelcome,1e3)}function createBookmark(e){const t=document.querySelector(".bookmarks"),o=document.querySelector("#bookmarkTemplate").cloneNode(!0);if(o.removeAttribute("id"),o.setAttribute("aria-label",e.name),o.setAttribute("href",e.url),e.icon.length){const r=document.createElement("i");r.classList.add(e.type,`fa-${e.icon}`),r.setAttribute("aria-hidden","true"),o.appendChild(r),t.insertBefore(o,t.querySelector(".add-bookmark"));const a=t.querySelectorAll("a i");if(a[a.length-1].offsetHeight)return e.icon}return o.innerText=e.name.charAt(0).toUpperCase(),t.insertBefore(o,t.querySelector(".add-bookmark")),""}function createManager(e){const t=document.querySelector(".bookmark-manager"),o=document.querySelector("#managerTemplate").cloneNode(!0);if(o.removeAttribute("id"),e.icon.length){const t=document.createElement("i");t.classList.add(e.type,`fa-${e.icon}`),t.setAttribute("aria-hidden","true"),o.querySelector(".panel-icon").appendChild(t)}else o.querySelector(".panel-icon").innerText=e.name.charAt(0).toUpperCase();o.querySelector(".panel-name").innerText=e.name,t.insertBefore(o,t.querySelector(".manager-footer"))}function updateBookmark(e){const t=localStorage.getItem("bookmarks"),o=JSON.parse(t);e?(o.push(e),localStorage.setItem("bookmarks",JSON.stringify(o))):null===t?localStorage.setItem("bookmarks",JSON.stringify([])):(document.querySelector(".bookmarks").innerHTML="",document.querySelector(".bookmark-manager").innerHTML="",o.forEach(e=>{createBookmark(e),createManager(e)}))}function addBookmark(){const e=document.querySelector("#addBookmark"),t=e.querySelectorAll("input, select"),o=t[0].value.trim(),r=t[1].value.trim(),a=t[2].value.trim().toLowerCase(),n=t[3].value;if(!o||!r)return o||(t[0].value=""),void(r||(t[1].value=""));if(/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&\/\/=]*)/.test(r)){const t=new Bookmarks(o,r,a,n);e.querySelector("form").reset(),resetAlerts(e.querySelector("form")),toggleModal("addBookmark"),t.icon=createBookmark(t),createManager(t),updateBookmark(t)}else t[1].classList.remove("is-primary"),t[1].classList.add("is-danger"),e.querySelector(".help").classList.remove("is-hidden")}function removeBookmark(e){const t=JSON.parse(localStorage.getItem("bookmarks"));t.splice(e,1),localStorage.setItem("bookmarks",JSON.stringify(t)),updateBookmark()}function RGBToHex(e){const t=e.indexOf(",")>-1?",":" ";let o=(+(e=e.substr(4).split(")")[0].split(t))[0]).toString(16),r=(+e[1]).toString(16),a=(+e[2]).toString(16);return 1===o.length&&(o=`0${o}`),1===r.length&&(r=`0${r}`),1===a.length&&(a=`0${a}`),`#${o}${r}${a}`}function hexToRGB(e){let t=0,o=0,r=0;return 4===e.length?(t=`0x${e[1]}${e[1]}`,o=`0x${e[2]}${e[2]}`,r=`0x${e[3]}${e[3]}`):7===e.length&&(t=`0x${e[1]}${e[2]}`,o=`0x${e[3]}${e[4]}`,r=`0x${e[5]}${e[6]}`),`rgb(${+t}, ${+o}, ${+r})`}function HSLToRGB(e){const t=e.indexOf(",")>-1?",":" ",o=(e=e.substr(4).split(")")[0].split(t))[0],r=e[1].substr(0,e[1].length-1)/100,a=e[2].substr(0,e[2].length-1)/100,n=(1-Math.abs(2*a-1))*r,s=n*(1-Math.abs(o/60%2-1)),i=a-n/2;let l=0,c=0,u=0;return o>=0&&o<60?(l=n,c=s,u=0):o>=60&&o<120?(l=s,c=n,u=0):o>=120&&o<180?(l=0,c=n,u=s):o>=180&&o<240?(l=0,c=s,u=n):o>=240&&o<300?(l=s,c=0,u=n):o>=300&&o<360&&(l=n,c=0,u=s),`rgb(${l=Math.round(255*(l+i))}, ${c=Math.round(255*(c+i))}, ${u=Math.round(255*(u+i))})`}function RGBToHSL(e){const t=e.indexOf(",")>-1?",":" ";e=e.substr(4).split(")")[0].split(t);for(const t in e){const o=e[t];o.indexOf("%")>-1&&(e[t]=Math.round(o.substr(0,o.length-1)/100*255))}const o=e[0]/255,r=e[1]/255,a=e[2]/255,n=Math.min(o,r,a),s=Math.max(o,r,a),i=s-n;let l=0,c=0,u=0;return l=0===i?0:s===o?(r-a)/i%6:s===r?(a-o)/i+2:(o-r)/i+4,(l=Math.round(60*l))<0&&(l+=360),u=(s+n)/2,`hsl(${l}, ${c=+(100*(c=0===i?0:i/(1-Math.abs(2*u-1)))).toFixed(1)}%, ${u=+(100*u).toFixed(1)}%)`}function toRGB(e){const t={hex:/^#([\da-f]{3}){1,2}$/i,rgb:/^rgb\((((((((1?[1-9]?\d)|10\d|(2[0-4]\d)|25[0-5]),\s?)){2}|((((1?[1-9]?\d)|10\d|(2[0-4]\d)|25[0-5])\s)){2})((1?[1-9]?\d)|10\d|(2[0-4]\d)|25[0-5]))|((((([1-9]?\d(\.\d+)?)|100|(\.\d+))%,\s?){2}|((([1-9]?\d(\.\d+)?)|100|(\.\d+))%\s){2})(([1-9]?\d(\.\d+)?)|100|(\.\d+))%))\)$/i,hsl:/^hsl\(((((([12]?[1-9]?\d)|[12]0\d|(3[0-5]\d))(\.\d+)?)|(\.\d+))(deg)?|(0|0?\.\d+)turn|(([0-6](\.\d+)?)|(\.\d+))rad)((,\s?(([1-9]?\d(\.\d+)?)|100|(\.\d+))%){2}|(\s(([1-9]?\d(\.\d+)?)|100|(\.\d+))%){2})\)$/i};return t.hex.test(e)?hexToRGB(e):t.rgb.test(e)?hexToRGB(RGBToHex(e)):!!t.hsl.test(e)&&HSLToRGB(e)}function cardContent(e){const t=`#${e.split(" ")[0].toLowerCase()}Template`;if(document.querySelector(t)){const e=document.querySelector(t).cloneNode(!0);return e.removeAttribute("id"),e.outerHTML}return"No card content found"}function toggleHideAll(e,t){e.querySelectorAll(t).forEach(e=>{"button"===e.tagName.toLowerCase()||"input"===e.tagName.toLowerCase()||"span"===e.tagName.toLowerCase()?e.classList.toggle("is-hidden"):e.toggleAttribute("hidden")})}function enableSorting(){const e=document.querySelector(".cards"),t=document.querySelector(".bookmarks"),o=document.querySelector(".bookmark-manager");function r(e,t,o){const r=JSON.parse(localStorage.getItem(e)),a=r.slice(t,t+1)[0];r.splice(t,1),r.splice(o,0,a),localStorage.setItem(e,JSON.stringify(r))}Sortable.create(e,{animation:300,emptyInsertThreshold:30,scroll:!0,scrollSensitivity:50,bubbleScroll:!0,handle:".message-header"}),Sortable.create(t,{animation:300,emptyInsertThreshold:30,scroll:!0,scrollSensitivity:50,bubbleScroll:!0,handle:"a",onEnd(e){r("bookmarks",e.oldIndex,e.newIndex),updateBookmark()}}),Sortable.create(o,{animation:300,emptyInsertThreshold:30,scroll:!0,scrollSensitivity:50,bubbleScroll:!0,handle:".manager-buttons a:first-of-type",onEnd(e){r("bookmarks",e.oldIndex,e.newIndex),updateBookmark()}})}function removeAnimation(e){e.classList.remove("animated","fadeInLeft","shake","rubberBand")}function limitString(e){const t=e.max.length;e.value.length>t&&(e.value=e.value.slice(0,t))}function timeChange(e){const t=Number(e.max),o=Number(e.min);Number(e.value)!==t&&0!==Number(e.value)||(e.value=""),(Number(e.value)===o||Number(e.value)>t-1)&&(e.value=t-1),e.value.length<e.max.length&&""!==e.value&&(e.value=0+e.value)}function toSeconds(e){return 60*e[0]*60+60*e[1]+e[2]}function copyToClipboard(e){if(/^[#rh]/.test(e.value)){e.select(),document.execCommand("copy");const t=e.parentNode.querySelector("i");t.classList.add("animated","rubberBand"),setTimeout(removeAnimation,1e3,t)}}function updateCardList(e,t){const o=JSON.parse(localStorage.getItem("cardList"));o[t]=e,localStorage.setItem("cardList",JSON.stringify(o))}updateTimeAndDate(),window.addEventListener("load",()=>{const e=document.querySelector(".focus-banner form"),t=document.querySelector(".search-provider"),o=document.querySelector(".board-background"),r=document.querySelector(".weather-location"),a=new Settings;if(null===localStorage.getItem("settings")?a.update():(Object.assign(a,JSON.parse(localStorage.getItem("settings"))),a.updateName(a.name),a.updateRadio(t,"provider"),a.updateProvider(),a.updateRadio(o,"background"),a.updateBackground()),updateBookmark(),localStorage.getItem("focus")){const t=JSON.parse(localStorage.getItem("focus"));addFocus(e,(new Date).toDateString()===t[1]?t[0]:"")}if(localStorage.getItem("unsplash")){const e=document.querySelector(".custom-background input"),t=JSON.parse(localStorage.getItem("unsplash"));e.setAttribute("value",t[0])}localStorage.getItem("coordinates")?updateWeather():document.querySelector(".weather a").innerText="Set Weather Forecast Location",document.querySelector(".sidebar").addEventListener("click",e=>{e.target.classList.contains("settings")?toggleModal("settings",1):e.target.classList.contains("bookmark")?toggleModal("settings",3):e.target.classList.contains("add-bookmark")&&toggleModal("addBookmark")}),document.querySelectorAll(".modal").forEach(e=>{e.addEventListener("click",t=>{t.target.classList.contains("close-modal")&&(toggleModal(e.id),e.querySelectorAll("form").forEach(e=>{e.reset(),resetAlerts(e)}))});const n=e.querySelectorAll(".modal-card-body .tabs");n.length&&n.forEach(e=>{e.addEventListener("click",t=>{"a"===t.target.tagName.toLowerCase()&&modalTabs(e.parentNode,t.target)})});const s=document.querySelector(".personal-name");s.addEventListener("input",e=>{const t=s.querySelector("input").value.trim();t!==a.name&&a.updateName(t),e.stopImmediatePropagation()}),t.addEventListener("click",e=>{"input"!==e.target.tagName.toLowerCase()&&"label"!==e.target.tagName.toLowerCase()||(a.updateRadio(t,"provider",e.target),a.updateProvider(),e.stopImmediatePropagation())}),o.addEventListener("click",e=>{"input"!==e.target.tagName.toLowerCase()&&"label"!==e.target.tagName.toLowerCase()||(a.updateRadio(o,"background",e.target),a.updateBackground(),e.stopImmediatePropagation())}),document.querySelector(".bookmark-manager").parentNode.addEventListener("click",e=>{if("Close"===e.target.name){removeBookmark(Array.prototype.indexOf.call(e.target.parentElement.parentElement.parentElement.children,e.target.parentElement.parentElement)),e.stopImmediatePropagation()}e.target.classList.contains("manager-footer")&&(toggleModal("settings"),toggleModal("addBookmark"),e.stopImmediatePropagation())}),r.addEventListener("click",e=>{"a"===e.target.tagName.toLowerCase()&&e.target.classList.contains("is-size-7")&&navigator.geolocation.getCurrentPosition(allow,block)})});const n=document.querySelector(".custom-background"),s=document.querySelector(".focus-banner"),i=document.querySelector("#addBookmark form"),l=document.querySelector(".weather-location"),c=document.querySelector(".search"),u=document.querySelector(".weather");c.querySelector("a").addEventListener("click",()=>{clickSearch(a)}),u.addEventListener("click",()=>{toggleModal("settings",4)}),e.addEventListener("submit",e=>{addFocus(e.target)}),c.addEventListener("submit",()=>{a.webSearch()}),i.addEventListener("submit",addBookmark),l.addEventListener("submit",updateCoords),n.addEventListener("submit",()=>{checkBackground(),a.updateBackground()}),updateWelcome(),s.removeAttribute("hidden")});class Card{constructor(e,t,o){this.ID=e,this.name=t,this.colour=o,this.collapse=!1,this.colourClass=function(e,t,o){let r=["is-dark","is-primary","is-info","is-success","is-warning"];return r[0]=t?"is-primary":r[0],o&&(r=r.map(function(e){return`has-text${e.slice(2)}`})),Number.isInteger(e)?r[e]:r[this.colour]}}appendCard(){const e=document.querySelector("#cardTemplate").cloneNode(!0),t=document.querySelector(".cards");e.setAttribute("id",`cardID-${this.ID}`),e.querySelector(".message-header p").innerText=this.name,e.querySelector(".message-body").innerHTML=cardContent(this.name),t.prepend(e),this.element=t.children[0],setTimeout(removeAnimation,1e3,this.element)}cycleColour(e){let t=this.colour;t=t>3?0:t+1,this.element.classList.remove(this.colourClass()),this.element.classList.add(this.colourClass(t)),e&&e.forEach(e=>{const o="a"===e.tagName.toLowerCase()||"p"===e.tagName.toLowerCase();e.classList.remove(this.colourClass(null,!0,o)),e.classList.add(this.colourClass(t,!0,o))}),this.colour=t,this.element.setAttribute("data-colour",this.colour)}collapseCard(){this.element.querySelector(".message-body").toggleAttribute("hidden"),this.element.querySelector(".fa-angle-up").classList.toggle("btn-rotate"),this.element.querySelector(".message-header").classList.toggle("round-header")}closeCard(){return this.element.remove(),this.element=null,this.ID-1}}class Notes extends Card{constructor(e,t,o){super(e,t,o),this.title=t,this.content=[],this.isChecked=[]}saveNote(e,t){const o=this.element.querySelector("input"),r=this.element.querySelector("textarea");t&&(o.setAttribute("value",this.title),r.innerText=this.content);const a=o.value.trim(),n=r.value.trim();a||n?(this.title=a||"Notepad",this.content=n,this.element.querySelector(".message-header p").innerText=this.title,this.element.querySelector(".notepad p").innerText=n,this.element.querySelector(".buttons").classList.toggle("is-centered"),this.element.querySelector(".buttons").classList.toggle("is-right"),toggleHideAll(e,".control, p, button, a")):(this.element.querySelector(".control input").value="",this.element.querySelector(".control textarea").value="")}addToList(e){const t=this.element.querySelector(".to-do-add input"),o=e||t.value.trim();if(o){e||this.content.push(o),t.value="";const r=document.querySelector("#checkboxTemplate").cloneNode(!0),a=r.querySelector("input"),n=r.querySelector("label"),s=Math.random().toString(36).substring(2)+Date.now().toString(36);r.removeAttribute("id"),a.id=`item-${this.ID}-${s}`,a.classList.add(this.colourClass(this.colour,!0)),n.setAttribute("for",`item-${this.ID}-${s}`),n.innerText=o,this.element.querySelector(".control").insertBefore(r,t.closest(".to-do-add"))}else this.element.querySelector(".to-do-add .control input").value=""}removeCheckedItems(){const e=this.isChecked.length;for(let t=0;t<e;t++)this.content.splice(this.isChecked[0]-t,1),this.isChecked.splice(0,1),this.element.querySelector(".checkbox-item .strike").parentNode.remove()}saveList(e,t){const o=this.element.querySelector("input");t&&o.setAttribute("value",this.title);const r=o.value.trim();r||this.content[0]?(this.title=r||"To-do List",this.element.querySelector(".message-header p").innerText=this.title,this.element.querySelector(".buttons").classList.toggle("is-centered"),this.element.querySelector(".buttons").classList.toggle("is-right"),toggleHideAll(e,"input, button, a")):this.element.querySelector(".control input").value=""}}class Clock extends Card{constructor(e,t,o){super(e,t,o),this.ends=[],this.play=!1,this.timeout=!1}startTimer(e){const t=this.element.querySelectorAll("input"),o=[];for(let e=0;e<t.length;e++)o[e]=Number(t[e].value);const r=toSeconds(o);r&&(this.ends=r,this.play=!0,this.runTimer(),toggleHideAll(e,"input, .colon, button, p, a"))}controlTimer(e){const t=this.element.querySelector(".buttons a");t===e?(t.querySelector("i").classList.toggle("fa-play"),t.querySelector("i").classList.toggle("fa-pause"),this.play=!this.play,this.play&&this.timeout&&this.runTimer()):this.resetTimer()}runTimer(){if(this.element){const e=this.ends,t=this.element.querySelector(".time-display");if(e)if(this.play){const o=new Date(1e3*e).toISOString().substr(11,8);t.innerHTML=o.replace(/:/g," : "),this.ends=e-1,this.timeout=!1,setTimeout(this.runTimer.bind(this),1e3)}else this.timeout=!0;else{const e=new Audio("https://d1490khl9dq1ow.cloudfront.net/sfx/mp3preview/alarm-clock-beep-1_zJgIn-Vd.mp3");setTimeout(removeAnimation,1e3,this.element),this.element.classList.add("animated","shake"),e.play(),e.play(),this.resetTimer()}}}resetTimer(){const e=this.element.querySelector(".time-display").closest("form"),t=this.element.querySelector(".buttons a");this.play=!1,t.querySelector("i").classList.remove("fa-play"),t.querySelector("i").classList.add("fa-pause"),toggleHideAll(e,"input, .colon, button, p, a")}}class Misc extends Card{constructor(e,t,o){super(e,t,o),this.entry="0"}calcAction(e){const t=this.entry.split(" ").splice(-1).toString();let o=!1;switch(!/[0-9]|^DEL$|\./.test(e)&&/\.$/.test(t)&&(this.entry=this.entry.substr(0,this.entry.length-1)),e){case"AC":this.entry="0";break;case"DEL":this.entry=/[+-x÷]\s$/.test(this.entry)?this.entry.substr(0,this.entry.length-3):this.entry.substr(0,this.entry.length-1),this.entry=0===this.entry.length?"0":this.entry;break;case"( )":if(/^0(?!\.)/.test(t))this.entry=`${this.entry.substr(0,this.entry.length-1)}(`;else if(/[(\s-]$/.test(this.entry))this.entry+="(";else{(this.entry.match(/\(/g)||[]).length-(this.entry.match(/\)/g)||[]).length?this.entry+=")":/[0-9).]$/.test(this.entry)&&(this.entry+=" x (")}break;case"=":this.entry=this.calcDisp(),o=!0;break;case"+":case"-":case"x":case"÷":if(/^0(?!\.)/.test(this.entry)){/^-$/.test(e)&&(this.entry=`(${e}`);break}/[0-9).]$/.test(this.entry)&&(this.entry+=` ${e} `),/\($/.test(this.entry)&&/^-$/.test(e)&&(this.entry+=e),/[+-x÷]\s$/.test(this.entry)&&(this.entry=`${this.entry.substr(0,this.entry.length-3)} ${e} `);break;case".":!/\./.test(t)&&/[^)]$/.test(this.entry)&&(this.entry+=e);break;default:if(/^0(?!\.)/.test(t)&&(this.entry=this.entry.substr(0,this.entry.length-1)),/\)$/.test(this.entry)&&(this.entry+=" x "),t.length>12)break;this.entry+=e}const r=this.element.querySelector(".calc-entry"),a=this.element.querySelector(".calc-preview");r.innerHTML=this.entry,a.innerHTML=this.calcDisp(o,!0)}calcFormat(){const e=(this.entry.match(/\(/g)||[]).length-(this.entry.match(/\)/g)||[]).length;let t=this.entry;return/[+-x÷]\s$/.test(this.entry)&&(t=t.substr(0,t.length-3)),t=(t+=")".repeat(e)).replace(/x/g,"*").replace(/÷/g,"/")}calcEval(){try{return eval(this.calcFormat()),!0}catch(e){return!1}}calcDisp(force,preview){const expression=this.calcFormat();if(this.calcEval())return preview&&(expression.trim().split(" ").length<3||!/[0-9).]$/.test(expression)||/\s$/.test(this.entry))?"&nbsp;":Number(eval(expression).toFixed(10)).toString();const foo=force?"Invalid expression":"&nbsp;";return preview?foo:expression.replace(/\*/g,"x").replace(/\//g,"÷")}convertColour(){const e=this.element.querySelector(".colour-code input"),t=this.element.querySelectorAll(".colour-codes input"),o=this.element.querySelector(".box"),r=e.value.trim();let a="rgb(255, 255, 255)";if(this.codes=["","",""],r){const e=toRGB(r);this.codes=this.codes.fill("Invalid colour code"),e&&(this.codes[0]=RGBToHex(e),this.codes[1]=e,this.codes[2]=RGBToHSL(e),a=e)}for(let e=0;e<this.codes.length;e++)t[e].value=this.codes[e];e.value=r,o.style.background=a}}window.addEventListener("load",()=>{const e=document.querySelector(".icon-menu").querySelectorAll("a"),t=document.querySelector(".cards");let o=new Array(10).fill(null);if(null===localStorage.getItem("cardList"))localStorage.setItem("cardList",JSON.stringify(o));else{const e=JSON.parse(localStorage.getItem("cardList"));for(let t=0;t<o.length;t++)if(null!==e[t]){switch(e[t].name){case"Notepad":case"To-do List":o[t]=new Notes;break;case"Timer":o[t]=new Clock;break;case"Calculator":case"Colour Converter":o[t]=new Misc;break;default:o[t]=new Card}Object.assign(o[t],e[t]),o[t].ID=t+1,o[t].appendCard(),o[t].collapse&&o[t].collapseCard();for(let e=0;e<5;e++)o[t].cycleColour(o[t].element.querySelectorAll(".themed"));if("Notepad"===o[t].name&&o[t].saveNote(o[t].element.querySelector("form"),!0),"To-do List"===o[t].name){o[t].content.forEach(e=>{o[t].addToList(e)}),o[t].saveList(o[t].element.querySelector("form"),!0);const e=o[t].element.querySelectorAll(".checkbox-item");o[t].isChecked.forEach(t=>{e[t].querySelector("input").setAttribute("checked",!0),e[t].querySelector("label").classList.toggle("strike")})}updateCardList(o[t],t)}}for(let t=0;t<e.length;t++)e[t].addEventListener("click",()=>{const r=["Notepad","To-do List"],a=["Timer"];let n=o.indexOf(null)+1;if(n)switch(r.indexOf(e[t].getAttribute("name"))+1?o[n-1]=new Notes(n,e[t].getAttribute("name"),0):a.indexOf(e[t].getAttribute("name"))+1?o[n-1]=new Clock(n,e[t].getAttribute("name"),0):o[n-1]=new Misc(n,e[t].getAttribute("name"),0),o[n-1].appendCard(),updateCardList(o[n-1],[n-1]),o[n-1].name){case"To-do List":o[n-1].element.addEventListener("submit",function(){o[n-1].addToList()})}else console.log("Card list total has been exceeded")});t.addEventListener("click",e=>{const t=e.target.closest("article"),r=t.id.substr(t.id.indexOf("-")+1,t.id.length)-1;if(e.target.parentNode.classList.contains("card-buttons")){switch(e.target.name){case"Colour":o[r].cycleColour(t.querySelectorAll(".themed"));break;case"Collapse":o[r].collapseCard(),o[r].collapse=!o[r].collapse;break;case"Close":o[o[r].closeCard()]=null;break;default:console.log('Incorrect button name (Accepted names: "Colour", "Collapse", "Close")')}updateCardList(o[r],r)}else{switch(o[r].name){case"Notepad":"Save"!==e.target.name&&"a"!==e.target.tagName.toLowerCase()||o[r].saveNote(e.target.closest("form"));break;case"To-do List":"Add"===e.target.name?o[r].addToList():"Remove"===e.target.name?o[r].removeCheckedItems():"Save"!==e.target.name&&"a"!==e.target.tagName.toLowerCase()||o[r].saveList(e.target.closest("form"));break;case"Timer":"Start"===e.target.name?o[r].startTimer(e.target.closest("form")):"a"===e.target.tagName.toLowerCase()&&o[r].controlTimer(e.target.closest("a"));break;case"Calculator":"span"===e.target.tagName.toLowerCase()&&o[r].calcAction(e.target.innerHTML);break;case"Colour Converter":"Convert"===e.target.name?o[r].convertColour():"Copy"===e.target.name&&copyToClipboard(e.target);break;default:console.log("No click event assigned")}updateCardList(o[r],r)}}),t.addEventListener("change",e=>{if("checkbox"===e.target.getAttribute("type")){const t=e.target.closest("article"),r=t.id.substr(t.id.indexOf("-")+1,t.id.length)-1,a=e.target.parentNode.querySelector("label"),n=Array.prototype.indexOf.call(e.target.parentElement.parentElement.children,e.target.parentElement)-1;a.classList.toggle("strike"),a.classList.contains("strike")?(o[r].isChecked.push(n),o[r].isChecked.sort(function(e,t){return e-t})):o[r].isChecked.splice(o[r].isChecked.indexOf(n),1),updateCardList(o[r],r)}}),enableSorting()}),function(e){"use strict";var t,o,r,a;r=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame,a=e.cancelAnimationFrame||e.webkitCancelAnimationFrame||e.mozCancelAnimationFrame||e.oCancelAnimationFrame||e.msCancelAnimationFrame,r&&a?(t=function(e){var t={value:null};return function o(){t.value=r(o),e()}(),t},o=function(e){a(e.value)}):(t=setInterval,o=clearInterval);var n=2*Math.PI,s=2/Math.sqrt(2);function i(e,t,o,r,a){e.beginPath(),e.moveTo(t,o),e.lineTo(r,a),e.stroke()}function l(e,t,o,r,a,s,i,l){var c=Math.cos(t*n);!function(e,t,o,r){e.beginPath(),e.arc(t,o,r,0,n,!1),e.fill()}(e,o-Math.sin(t*n)*a,r+c*s+.5*(l-=i),i+(1-.5*c)*l)}function c(e,t,o,r,a,n,s,i){var c;for(c=5;c--;)l(e,t+c/5,o,r,a,n,s,i)}function u(e,t,o,r,a,n,s){t/=3e4;var i=.21*a,l=.12*a,u=.24*a,d=.28*a;e.fillStyle=s,c(e,t,o,r,i,l,u,d),e.globalCompositeOperation="destination-out",c(e,t,o,r,i,l,u-n,d-n),e.globalCompositeOperation="source-over"}function d(e,t,o,r,a,s,l){t/=12e4;var c,u,d,h,m=.25*a-.5*s,g=.32*a+.5*s,p=.5*a-.5*s;for(e.strokeStyle=l,e.lineWidth=s,e.lineCap="round",e.lineJoin="round",e.beginPath(),e.arc(o,r,m,0,n,!1),e.stroke(),c=8;c--;)u=(t+c/8)*n,i(e,o+(d=Math.cos(u))*g,r+(h=Math.sin(u))*g,o+d*p,r+h*p)}function h(e,t,o,r,a,i,l){t/=15e3;var c=.29*a-.5*i,u=.05*a,d=Math.cos(t*n),h=d*n/-16;e.strokeStyle=l,e.lineWidth=i,e.lineCap="round",e.lineJoin="round",o+=d*u,e.beginPath(),e.arc(o,r,c,h+n/8,h+7*n/8,!1),e.arc(o+Math.cos(h)*c*s,r+Math.sin(h)*c*s,c,h+5*n/8,h+3*n/8,!0),e.closePath(),e.stroke()}var m=[[-.75,-.18,-.7219,-.1527,-.6971,-.1225,-.6739,-.091,-.6516,-.0588,-.6298,-.0262,-.6083,.0065,-.5868,.0396,-.5643,.0731,-.5372,.1041,-.5033,.1259,-.4662,.1406,-.4275,.1493,-.3881,.153,-.3487,.1526,-.3095,.1488,-.2708,.1421,-.2319,.1342,-.1943,.1217,-.16,.1025,-.129,.0785,-.1012,.0509,-.0764,.0206,-.0547,-.012,-.0378,-.0472,-.0324,-.0857,-.0389,-.1241,-.0546,-.1599,-.0814,-.1876,-.1193,-.1964,-.1582,-.1935,-.1931,-.1769,-.2157,-.1453,-.229,-.1085,-.2327,-.0697,-.224,-.0317,-.2064,.0033,-.1853,.0362,-.1613,.0672,-.135,.0961,-.1051,.1213,-.0706,.1397,-.0332,.1512,.0053,.158,.0442,.1624,.0833,.1636,.1224,.1615,.1613,.1565,.1999,.15,.2378,.1402,.2749,.1279,.3118,.1147,.3487,.1015,.3858,.0892,.4236,.0787,.4621,.0715,.5012,.0702,.5398,.0766,.5768,.089,.6123,.1055,.6466,.1244,.6805,.144,.7147,.163,.75,.18],[-.75,0,-.7033,.0195,-.6569,.0399,-.6104,.06,-.5634,.0789,-.5155,.0954,-.4667,.1089,-.4174,.1206,-.3676,.1299,-.3174,.1365,-.2669,.1398,-.2162,.1391,-.1658,.1347,-.1157,.1271,-.0661,.1169,-.017,.1046,.0316,.0903,.0791,.0728,.1259,.0534,.1723,.0331,.2188,.0129,.2656,-.0064,.3122,-.0263,.3586,-.0466,.4052,-.0665,.4525,-.0847,.5007,-.1002,.5497,-.113,.5991,-.124,.6491,-.1325,.6994,-.138,.75,-.14]],g=[{start:.36,end:.11},{start:.56,end:.16}];function p(e,t,o,r,a,s,i,l,c){t/=2500;var u,d,h,p,y=m[i],f=(t+i-g[i].start)%l,b=(t+i-g[i].end)%l,S=(t+i)%l;if(e.strokeStyle=c,e.lineWidth=s,e.lineCap="round",e.lineJoin="round",f<1){if(e.beginPath(),f*=y.length/2-1,f-=u=Math.floor(f),u*=2,u+=2,e.moveTo(o+(y[u-2]*(1-f)+y[u]*f)*a,r+(y[u-1]*(1-f)+y[u+1]*f)*a),b<1){for(b*=y.length/2-1,b-=d=Math.floor(b),d*=2,d+=2,p=u;p!==d;p+=2)e.lineTo(o+y[p]*a,r+y[p+1]*a);e.lineTo(o+(y[d-2]*(1-b)+y[d]*b)*a,r+(y[d-1]*(1-b)+y[d+1]*b)*a)}else for(p=u;p!==y.length;p+=2)e.lineTo(o+y[p]*a,r+y[p+1]*a);e.stroke()}else if(b<1){for(e.beginPath(),b*=y.length/2-1,b-=d=Math.floor(b),d*=2,d+=2,e.moveTo(o+y[0]*a,r+y[1]*a),p=2;p!==d;p+=2)e.lineTo(o+y[p]*a,r+y[p+1]*a);e.lineTo(o+(y[d-2]*(1-b)+y[d]*b)*a,r+(y[d-1]*(1-b)+y[d+1]*b)*a),e.stroke()}S<1&&(S*=y.length/2-1,S-=h=Math.floor(S),h*=2,function(e,t,o,r,a,s,i){var l=a/8,c=l/3,u=2*c,d=t%1*n,h=Math.cos(d),m=Math.sin(d);e.fillStyle=i,e.strokeStyle=i,e.lineWidth=s,e.lineCap="round",e.lineJoin="round",e.beginPath(),e.arc(o,r,l,d,d+Math.PI,!1),e.arc(o-c*h,r-c*m,u,d+Math.PI,d,!1),e.arc(o+u*h,r+u*m,c,d+Math.PI,d,!0),e.globalCompositeOperation="destination-out",e.fill(),e.globalCompositeOperation="source-over",e.stroke()}(e,t,o+(y[(h+=2)-2]*(1-S)+y[h]*S)*a,r+(y[h-1]*(1-S)+y[h+1]*S)*a,a,s,c))}var y=function(e){this.list=[],this.interval=null,this.color=e&&e.color?e.color:"black",this.resizeClear=!(!e||!e.resizeClear)};y.CLEAR_DAY=function(e,t,o){var r=e.canvas.width,a=e.canvas.height,n=Math.min(r,a);d(e,t,.5*r,.5*a,n,.08*n,o)},y.CLEAR_NIGHT=function(e,t,o){var r=e.canvas.width,a=e.canvas.height,n=Math.min(r,a);h(e,t,.5*r,.5*a,n,.08*n,o)},y.PARTLY_CLOUDY_DAY=function(e,t,o){var r=e.canvas.width,a=e.canvas.height,n=Math.min(r,a);d(e,t,.625*r,.375*a,.75*n,.08*n,o),u(e,t,.375*r,.625*a,.75*n,.08*n,o)},y.PARTLY_CLOUDY_NIGHT=function(e,t,o){var r=e.canvas.width,a=e.canvas.height,n=Math.min(r,a);h(e,t,.667*r,.375*a,.75*n,.08*n,o),u(e,t,.375*r,.625*a,.75*n,.08*n,o)},y.CLOUDY=function(e,t,o){var r=e.canvas.width,a=e.canvas.height,n=Math.min(r,a);u(e,t,.5*r,.5*a,n,.08*n,o)},y.RAIN=function(e,t,o){var r=e.canvas.width,a=e.canvas.height,s=Math.min(r,a);!function(e,t,o,r,a,s,i){t/=1350;var l,c,u,d,h=.16*a,m=11*n/12,g=7*n/12;for(e.fillStyle=i,l=4;l--;)u=o+(l-1.5)/1.5*(1===l||2===l?-1:1)*h,d=r+(c=(t+l/4)%1)*c*a,e.beginPath(),e.moveTo(u,d-1.5*s),e.arc(u,d,.75*s,m,g,!1),e.fill()}(e,t,.5*r,.37*a,.9*s,.08*s,o),u(e,t,.5*r,.37*a,.9*s,.08*s,o)},y.SLEET=function(e,t,o){var r=e.canvas.width,a=e.canvas.height,n=Math.min(r,a);!function(e,t,o,r,a,n,s){t/=750;var l,c,u,d,h=.1875*a;for(e.strokeStyle=s,e.lineWidth=.5*n,e.lineCap="round",e.lineJoin="round",l=4;l--;)c=(t+l/4)%1,i(e,u=Math.floor(o+(l-1.5)/1.5*(1===l||2===l?-1:1)*h)+.5,(d=r+c*a)-1.5*n,u,d+1.5*n)}(e,t,.5*r,.37*a,.9*n,.08*n,o),u(e,t,.5*r,.37*a,.9*n,.08*n,o)},y.SNOW=function(e,t,o){var r=e.canvas.width,a=e.canvas.height,s=Math.min(r,a);!function(e,t,o,r,a,s,l){var c,u,d,h,m=.16*a,g=.75*s,p=(t/=3e3)*n*.7,y=Math.cos(p)*g,f=Math.sin(p)*g,b=p+n/3,S=Math.cos(b)*g,v=Math.sin(b)*g,k=p+2*n/3,q=Math.cos(k)*g,L=Math.sin(k)*g;for(e.strokeStyle=l,e.lineWidth=.5*s,e.lineCap="round",e.lineJoin="round",c=4;c--;)u=(t+c/4)%1,i(e,(d=o+Math.sin((u+c/4)*n)*m)-y,(h=r+u*a)-f,d+y,h+f),i(e,d-S,h-v,d+S,h+v),i(e,d-q,h-L,d+q,h+L)}(e,t,.5*r,.37*a,.9*s,.08*s,o),u(e,t,.5*r,.37*a,.9*s,.08*s,o)},y.WIND=function(e,t,o){var r=e.canvas.width,a=e.canvas.height,n=Math.min(r,a);p(e,t,.5*r,.5*a,n,.08*n,0,2,o),p(e,t,.5*r,.5*a,n,.08*n,1,2,o)},y.FOG=function(e,t,o){var r=e.canvas.width,a=e.canvas.height,s=Math.min(r,a),l=.08*s;!function(e,t,o,r,a,n,s){t/=3e4;var i=.21*a,l=.06*a,u=.21*a,d=.28*a;e.fillStyle=s,c(e,t,o,r,i,l,u,d),e.globalCompositeOperation="destination-out",c(e,t,o,r,i,l,u-n,d-n),e.globalCompositeOperation="source-over"}(e,t,.5*r,.32*a,.75*s,l,o),t/=5e3;var u=Math.cos(t*n)*s*.02,d=Math.cos((t+.25)*n)*s*.02,h=Math.cos((t+.5)*n)*s*.02,m=Math.cos((t+.75)*n)*s*.02,g=.936*a,p=Math.floor(g-.5*l)+.5,y=Math.floor(g-2.5*l)+.5;e.strokeStyle=o,e.lineWidth=l,e.lineCap="round",e.lineJoin="round",i(e,u+.2*r+.5*l,p,d+.8*r-.5*l,p),i(e,h+.2*r+.5*l,y,m+.8*r-.5*l,y)},y.prototype={_determineDrawingFunction:function(e){return"string"==typeof e&&(e=y[e.toUpperCase().replace(/-/g,"_")]||null),e},add:function(e,t){var o;"string"==typeof e&&(e=document.getElementById(e)),null!==e&&"function"==typeof(t=this._determineDrawingFunction(t))&&(o={element:e,context:e.getContext("2d"),drawing:t},this.list.push(o),this.draw(o,500))},set:function(e,t){var o;for("string"==typeof e&&(e=document.getElementById(e)),o=this.list.length;o--;)if(this.list[o].element===e)return this.list[o].drawing=this._determineDrawingFunction(t),void this.draw(this.list[o],500);this.add(e,t)},remove:function(e){var t;for("string"==typeof e&&(e=document.getElementById(e)),t=this.list.length;t--;)if(this.list[t].element===e)return void this.list.splice(t,1)},draw:function(e,t){var o=e.context.canvas;this.resizeClear?o.width=o.width:e.context.clearRect(0,0,o.width,o.height),e.drawing(e.context,t,this.color)},play:function(){var e=this;this.pause(),this.interval=t(function(){var t,o=Date.now();for(t=e.list.length;t--;)e.draw(e.list[t],o)},1e3/60)},pause:function(){this.interval&&(o(this.interval),this.interval=null)}},e.Skycons=y}(this);